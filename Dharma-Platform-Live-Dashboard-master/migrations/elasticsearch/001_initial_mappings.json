{
  "version": "1.0.0",
  "name": "initial_mappings",
  "description": "Create initial Elasticsearch indexes and mappings for search and analytics",
  "database_type": "elasticsearch",
  "migration_type": "schema",
  "operations": [
    {
      "type": "create_index",
      "index": "posts",
      "mapping": {
        "properties": {
          "platform": {
            "type": "keyword"
          },
          "post_id": {
            "type": "keyword"
          },
          "content": {
            "type": "text",
            "analyzer": "standard",
            "fields": {
              "keyword": {
                "type": "keyword",
                "ignore_above": 256
              }
            }
          },
          "user_id": {
            "type": "keyword"
          },
          "username": {
            "type": "keyword"
          },
          "timestamp": {
            "type": "date"
          },
          "sentiment": {
            "type": "keyword"
          },
          "sentiment_confidence": {
            "type": "float"
          },
          "risk_score": {
            "type": "float"
          },
          "bot_probability": {
            "type": "float"
          },
          "language": {
            "type": "keyword"
          },
          "geolocation": {
            "type": "geo_point"
          },
          "hashtags": {
            "type": "keyword"
          },
          "mentions": {
            "type": "keyword"
          },
          "urls": {
            "type": "keyword"
          },
          "metrics": {
            "properties": {
              "likes": {
                "type": "integer"
              },
              "shares": {
                "type": "integer"
              },
              "comments": {
                "type": "integer"
              },
              "views": {
                "type": "integer"
              }
            }
          },
          "propaganda_techniques": {
            "type": "keyword"
          },
          "campaign_id": {
            "type": "keyword"
          }
        }
      },
      "settings": {
        "number_of_shards": 3,
        "number_of_replicas": 1,
        "analysis": {
          "analyzer": {
            "content_analyzer": {
              "type": "custom",
              "tokenizer": "standard",
              "filter": [
                "lowercase",
                "stop",
                "snowball"
              ]
            }
          }
        }
      }
    },
    {
      "type": "create_index",
      "index": "campaigns",
      "mapping": {
        "properties": {
          "name": {
            "type": "text",
            "fields": {
              "keyword": {
                "type": "keyword"
              }
            }
          },
          "description": {
            "type": "text"
          },
          "detection_date": {
            "type": "date"
          },
          "status": {
            "type": "keyword"
          },
          "coordination_score": {
            "type": "float"
          },
          "participant_count": {
            "type": "integer"
          },
          "post_count": {
            "type": "integer"
          },
          "platforms": {
            "type": "keyword"
          },
          "keywords": {
            "type": "keyword"
          },
          "hashtags": {
            "type": "keyword"
          },
          "sentiment_distribution": {
            "properties": {
              "pro_india": {
                "type": "float"
              },
              "neutral": {
                "type": "float"
              },
              "anti_india": {
                "type": "float"
              }
            }
          },
          "geographic_distribution": {
            "type": "geo_point"
          },
          "impact_metrics": {
            "properties": {
              "reach": {
                "type": "integer"
              },
              "engagement": {
                "type": "integer"
              },
              "virality_score": {
                "type": "float"
              }
            }
          }
        }
      },
      "settings": {
        "number_of_shards": 2,
        "number_of_replicas": 1
      }
    },
    {
      "type": "create_index",
      "index": "user_profiles",
      "mapping": {
        "properties": {
          "platform": {
            "type": "keyword"
          },
          "user_id": {
            "type": "keyword"
          },
          "username": {
            "type": "keyword"
          },
          "display_name": {
            "type": "text",
            "fields": {
              "keyword": {
                "type": "keyword"
              }
            }
          },
          "bio": {
            "type": "text"
          },
          "follower_count": {
            "type": "integer"
          },
          "following_count": {
            "type": "integer"
          },
          "post_count": {
            "type": "integer"
          },
          "account_created": {
            "type": "date"
          },
          "verified": {
            "type": "boolean"
          },
          "bot_probability": {
            "type": "float"
          },
          "behavioral_features": {
            "properties": {
              "posting_frequency": {
                "type": "float"
              },
              "avg_time_between_posts": {
                "type": "float"
              },
              "content_diversity": {
                "type": "float"
              },
              "network_centrality": {
                "type": "float"
              }
            }
          },
          "risk_indicators": {
            "type": "keyword"
          },
          "last_analyzed": {
            "type": "date"
          }
        }
      },
      "settings": {
        "number_of_shards": 2,
        "number_of_replicas": 1
      }
    },
    {
      "type": "create_alias",
      "alias": "posts_current",
      "index": "posts"
    },
    {
      "type": "create_alias",
      "alias": "campaigns_active",
      "index": "campaigns"
    }
  ]
}